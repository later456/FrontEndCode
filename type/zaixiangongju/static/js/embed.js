var XLM=XLM||{};XLM.HANGHOUTSCOLLAPSED="HANGHOUTSCOLLAPSED",XLM.HANGOUTSEXPANDED="HANGOUTSEXPANDED",XLM.HANGOUTS_STATUS=null,XLM.HANGOUTS_ALIGN=null,XLM.mobilecheck=function(){return void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")},XLM.buildHangoutsIframe=function(){var e=document.createElement("iframe");return e.setAttribute("frameborder","0"),e.setAttribute("scrolling","no"),e.setAttribute("id","xianliaome_window"),e.style.position="fixed",e.style.zIndex=1e4,e.style.width=0,e.style.height=0,e},XLM.buildDomain=function(){var e=window.xlm_url;return"http:"===window.location.protocol&&(e=e.replace("https://","http://")),e},XLM.buildHangoutsIframeURL=function(){var e=XLM.buildDomain();return e+="s/"+xlm_wid+"?",e+="domain="+encodeURIComponent(window.location.protocol+"//"+window.location.host)},XLM.buildDynamicPayload=function(){var e={};if(e.xlm_wid=window.xlm_wid,e.cd=encodeURIComponent(window.location.protocol+"//"+window.location.host),e.url=encodeURIComponent(window.location.href.substring(0,256)),void 0!==window.xlm_uid){var t=void 0!==window.xlm_avatar?window.xlm_avatar:"",o=[];(t=(t=t.replace(/"/g," ")).replace(/'/g," ")).replace(/(https?:\/\/[^\s]+)/g,function(e){return o.push(e),e}),t=o.length>0?o[0]:"";var a=void 0!==window.xlm_gid?window.xlm_gid:"",n=void 0!==window.xlm_isAdmin?window.xlm_isAdmin:"0";e.isAdmin=n,e.uid=window.xlm_uid,e.ts=window.xlm_time,e.token=window.xlm_hash,e.username=encodeURIComponent(window.xlm_name),e.avatar=encodeURIComponent(t),e.gid=encodeURIComponent(a)}return e},XLM.renderBanner=function(e){var t=document.getElementById("xianliaome_banner");t&&t.remove();var o=document.createElement("iframe");o.setAttribute("src",e),o.setAttribute("frameborder","0"),o.setAttribute("scrolling","no"),o.setAttribute("id","xianliaome_banner"),o.style.position="fixed",o.style.display="block",o.style.marginLeft="auto",o.style.marginRight="auto",o.style.left="0",o.style.right="0",o.style.width=XLM.mobilecheck()?"100%":"738px",XLM.mobilecheck()?o.style.height="60px":o.style.height="100px",o.style.top=XLM.mobilecheck()?"0px":"10px",o.style.zIndex=9999,document.body.appendChild(o)},XLM.removeBanner=function(){var e=document.getElementById("xianliaome_banner");e&&e.remove()},XLM.renderAds=function(e){var t=document.getElementById("xianliaome_ads");t&&t.remove();var o=document.createElement("iframe");o.setAttribute("src",e),o.setAttribute("frameborder","0"),o.setAttribute("scrolling","no"),o.setAttribute("id","xianliaome_ads"),o.style.position="fixed",o.style.display="block",o.style.marginLeft="auto",o.style.marginRight="auto",o.style.left="0",o.style.right="0",o.style.width=XLM.mobilecheck()?"100%":"738px",XLM.mobilecheck()?o.style.height="60px":o.style.height="100px",o.style.bottom=XLM.mobilecheck()?"0px":"10px",o.style.zIndex=9999,document.body.appendChild(o)},XLM.removeAds=function(){var e=document.getElementById("xianliaome_ads");e&&e.remove()},XLM.showAds=function(e){var t;if(function(){var e=!1,t=localStorage.getItem("lastSawAdsTimestamp")?localStorage.getItem("lastSawAdsTimestamp"):0;t=parseInt(t,10),Date.now()-t>864e5&&(localStorage.setItem("lastSawAdsTimestamp",0),localStorage.setItem("adsSaw",0));var o=localStorage.getItem("adsSaw")?localStorage.getItem("adsSaw"):0;return(o=parseInt(o,10))<100&&(e=!0),e}()){var o=XLM.buildDomain()+e;o+="?wid="+window.xlm_wid,o+="&domain="+encodeURIComponent(window.location.protocol+"//"+window.location.host),XLM.renderAds(o),t=localStorage.getItem("adsSaw")?localStorage.getItem("adsSaw"):0,t=parseInt(t,10),t+=1,localStorage.setItem("adsSaw",t),localStorage.setItem("lastSawAdsTimestamp",Date.now())}},XLM.closeAds=function(){localStorage.setItem("adsSaw",999),localStorage.setItem("lastSawAdsTimestamp",Date.now()),XLM.removeAds()},XLM.showNotice=function(e){var t=window.localStorage.getItem("last_closed_notice_id_of_website_"+xlm_wid);if(t=t||0,!(parseInt(e)<=parseInt(t))){var o=XLM.buildDomain()+"announcement/"+e;o+="?domain="+encodeURIComponent(window.location.protocol+"//"+window.location.host),XLM.renderBanner(o)}},XLM.closeNotice=function(e){window.localStorage.setItem("last_closed_notice_id_of_website_"+xlm_wid,e),XLM.removeBanner()},XLM.renderCollapsedHangouts=function(){if(XLM.hangouts&&XLM.HANGOUTS_STATUS!==XLM.HANGHOUTSCOLLAPSED){switch(document.body.style.overflow="",XLM.mobilecheck()?(XLM.hangouts.style.width="1px",XLM.hangouts.style.height="1px"):(XLM.hangouts.style.width="70px",XLM.hangouts.style.height="70px"),XLM.HANGOUTS_ALIGN){case"right":XLM.hangouts.style.top="",XLM.hangouts.style.right="0px",XLM.hangouts.style.bottom="0px",XLM.hangouts.style.left="";break;case"left":XLM.hangouts.style.top="",XLM.hangouts.style.right="",XLM.hangouts.style.bottom="0px",XLM.hangouts.style.left="0px"}setTimeout(function(){XLM.HANGOUTS_STATUS=XLM.HANGHOUTSCOLLAPSED},500)}},XLM.renderExpandedHangouts=function(){XLM.hangouts&&XLM.HANGOUTS_STATUS!==XLM.HANGOUTSEXPANDED&&(document.body.style.overflow="hidden",XLM.hangouts.style.width="100%",XLM.hangouts.style.height="100%",XLM.hangouts.style.top="0px",XLM.hangouts.style.right="",XLM.hangouts.style.bottom="",XLM.hangouts.style.left="0px",setTimeout(function(){XLM.HANGOUTS_STATUS=XLM.HANGOUTSEXPANDED},500))},XLM.showNewMessage=function(){XLM.hangouts&&(XLM.HANGOUTS_STATUS=XLM.HANGHOUTSCOLLAPSED)&&(XLM.hangouts.style.width="340px")},XLM.attachIframe=function(){XLM.hangouts=XLM.buildHangoutsIframe(),document.body.appendChild(XLM.hangouts);var e=XLM.hangouts.contentWindow;window.addEventListener("message",function(t){if("string"==typeof t.data)switch(t.data){case"HANGOUTS_REQUEST_DYNAMIC_PAYLOAD":e.postMessage({name:"DYNAMIC_PAYLOAD",payload:XLM.buildDynamicPayload()},XLM.buildDomain());break;case"HANGOUTS_OPEN_MODE":XLM.renderExpandedHangouts();break;case"HANGOUTS_CLOSE_MODE":XLM.renderCollapsedHangouts();break;case"NEW_MESSAGE":XLM.showNewMessage()}else switch(t.data.name){case"HANGOUTS_INITIALIZED":XLM.HANGOUTS_ALIGN=t.data.payload.alignment,XLM.renderCollapsedHangouts();break;case"ALIGN":XLM.HANGOUTS_ALIGN=t.data.payload;break;case"SHOW_NOTICE":XLM.showNotice(t.data.payload);break;case"CLOSE_NOTICE":XLM.closeNotice(t.data.payload);break;case"SHOW_ADS":XLM.showAds(t.data.payload);break;case"CLOSE_ADS":XLM.closeAds()}},!1),XLM.hangouts.setAttribute("src",XLM.buildHangoutsIframeURL())},XLM.attachIframe();